version: '3.7'
services:
  db:
    image: mysql:5.7
    restart: always
    environment:
      MYSQL_DATABASE: 'AmazonProductDatabase'
      # So you don't have to use root, but you can if you like
      MYSQL_USER: 'Kabil'
      # You can use whatever password you like
      MYSQL_PASSWORD: 'Electronic1702!'
      # Password for root access
      MYSQL_ROOT_PASSWORD: 'Electronic1702!'
    ports:
      # <Port exposed> : < MySQL Port running inside container>
      - '8306:3306'
    expose:
      # Opens port 3306 on the container
      - '3306'
      # Where our data will be persisted
    volumes:
      - my-db:/var/lib/mysql
  server:
        build:
          context: .
          dockerfile: Dockerfile
        env_file: .env
        depends_on:
          - db
        networks:
          - default
        ports:
        - "8082:10001" 
# Names our volume
volumes:
  my-db:



# version: '3.3'
# services:
#   app:
#     container_name: productdatamodel_app
#     build: .
#     ports: 
#       - 8080:8080 
#     restart: on-failure
#     volumes:
#       - api:/usr/src/app/
#     depends_on:
#       - productdatamodel-mysql           # Uncomment this when using mysql.
#     networks:
#       - productdatamodel



  
# productdatamodel-mysql:
#     image: mysql:5.7
#     container_name: db_mysql
#     ports: 
#       - 3306:3306
#     environment: 
#       - MYSQL_ROOT_HOST=${DB_HOST} 
#       - MYSQL_USER=${DB_USER}
#       - MYSQL_PASSWORD=${DB_PASSWORD}
#       - MYSQL_DATABASE=${DB_NAME}
#       - MYSQL_ROOT_PASSWORD=${DB_PASSWORD}
#     volumes:
#       - database_mysql:/var/lib/mysql
#     networks:
#       - productdatamodel
  
# phpmyadmin:
#     image: phpmyadmin/phpmyadmin
#     container_name: phpmyadmin_container
#     depends_on:
#       - productdatamodel-mysql
#     environment:
#       - PMA_HOST=mysql 
#       - PMA_USER=${DB_USER}
#       - PMA_PORT=${DB_PORT}
#       - PMA_PASSWORD=${DB_PASSWORD}
#     ports:
#       - 9090:80
#     restart: always
#     networks:
#       - productdatamodel


# volumes:
#   api:
#   database_mysql:                   

# networks:
#   productdatamodel:
#     driver: bridge